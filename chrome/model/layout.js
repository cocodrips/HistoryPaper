// Generated by CoffeeScript 1.6.3
(function() {
  this.Layout = (function() {
    function Layout() {
      this.aspect = 1.3;
      this.clusterNum = 15;
      this.squareSize = 0;
      this.rows = 0;
      this.cols = 0;
    }

    Layout.prototype.createLayout = function() {
      var data, h, w;
      w = window.innerWidth;
      h = window.innerHeight;
      this.calcSquareSize(w, h);
      data = this.calcPosition(w);
      return this.arrangeArticles(data);
    };

    Layout.prototype.calcSquareSize = function(width, height) {
      var cols, rectangleWidth, rows, squareSize;
      rectangleWidth = width / this.aspect;
      squareSize = height;
      cols = 0;
      rows = 1;
      while (cols * rows < this.clusterNum) {
        cols++;
        squareSize = height / cols;
        rows = Math.round(rectangleWidth / squareSize);
      }
      this.cols = cols;
      this.rows = rows;
      return this.squareSize = squareSize;
    };

    Layout.prototype.calcPosition = function(w) {
      var articleHeight, articleWidth, c, historyObjects, obj, r, _i, _j, _ref, _ref1;
      historyObjects = [];
      articleWidth = this.squareSize * (w / (this.squareSize * this.cols));
      articleHeight = this.squareSize;
      for (c = _i = 0, _ref = this.cols; 0 <= _ref ? _i < _ref : _i > _ref; c = 0 <= _ref ? ++_i : --_i) {
        for (r = _j = 0, _ref1 = this.rows; 0 <= _ref1 ? _j < _ref1 : _j > _ref1; r = 0 <= _ref1 ? ++_j : --_j) {
          obj = new HistoryObject();
          obj.left = r * articleWidth;
          obj.top = c * articleHeight;
          obj.width = articleWidth;
          obj.height = articleHeight;
          historyObjects[(c * this.rows) + r] = obj;
        }
      }
      return historyObjects;
    };

    Layout.prototype.arrangeArticles = function(data) {
      return d3.select("#main-container").selectAll("article").data(data).enter().append("article").attr("class", "article").style("width", function(d) {
        return d.width + "px";
      }).style("height", function(d) {
        return d.height + "px";
      }).style("top", function(d) {
        return d.top + "px";
      }).style("left", function(d) {
        return d.left + "px";
      }).text("object");
    };

    return Layout;

  })();

}).call(this);
